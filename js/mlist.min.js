(function(){function e(i){return new d(i)}function d(i){this.params={elementId:i.elementId||null,itemId:i.itemId||null,query:i.query||null,queryType:i.queryType||"GET",condition:i.condition||null,items:i.items||null,details:i.details||null,action:i.action||null,showNumber:i.showNumber||false,showArrow:i.showArrow||false,buttons:i.buttons||null,imgSrc:i.imgSrc||null,icon:i.icon||null,className:i.className||null,dataAdapter:i.dataAdapter||null,complete:i.complete||null};this.element=$("#"+this.params.elementId);this.element.addClass("list-group mlist-list")}d.prototype.query=function(){var k=this.params;var i=k.elementId;var j=this.element;$.ajax({url:k.query,type:k.queryType,data:k.condition,dataType:"json",success:function(l){if(k["dataAdapter"]&&typeof k["dataAdapter"]==="function"){l=k.dataAdapter(l)}f[i]=l;var p="";for(var o=0,s=l.length;o<s;o++){var q=l[o];var n="$('#"+i+"').MList('toggle',"+o+")";var m='<a class="list-group-item ';if(k["className"]){m+=k.className+" "}m+='mlist-item" href="javascript:'+n+';"';if(k["itemId"]){m+=' item-id="'+q[k["itemId"]]+'"'}if(k["action"]&&typeof k.action==="function"){var r="$('#"+i+"').MList('click',"+o+")";m+=' onclick="'+r+'"'}m+=">";if(k["showNumber"]){m+="<span>"+(o+1)+"</span> "}if(k["imgSrc"]){m+='<img src="'+k.imgSrc+'" /> '}if(k["icon"]){m+='<span class="'+k.icon+'"></span> '}m+=c(k["items"],q);if(k["showArrow"]){m+='<span class="pull-right">&gt;</span>'}m+="</a>";m+='<div class="list-group mlist-details" style="display:none;">';m+=b(k["details"],q);m+=g(k["buttons"],i,o);m+="</div>";p+=m}j.html(p);if(k["complete"]){k.complete(l,j)}}});console.info(this.params.query)};d.prototype.toggle=function(i){var j=this.element;j.find(".mlist-details").eq(i).slideToggle()};d.prototype.click=function(k){var p=this.params;var l=this.element;var m=l.find(".mlist-item").eq(k);var j=p.elementId;var i=f[j];var n=i[k];var o=p["itemId"]?n[p.itemId]:null;p.action(o,n,m)};d.prototype.operate=function(i){var o=i[0];var q=i[1];var j=this.params;var l=this.element;var r=l.find(".mlist-item").eq(o);var m=j.elementId;var n=f[m];var k=n[o];var p=j["itemId"]?k[j.itemId]:null;j.buttons[q].action(p,k,r)};d.prototype.getDatas=function(){var j=this.params;var i=j.elementId;return f[i]};d.prototype.getRow=function(j){var k=this.params;var i=k.elementId;return f[i][j]};function c(i,m){var j="<span>";for(var l=0,p=i.length;l<p;l++){var k=i[l];var o=k["index"];var n="<span>";n+=h(k["formatter"],m[o],m);n+="</span> ";j+=n}j+="</span>";return j}function b(i,n){var o="";for(var m=0,l=i.length;m<l;m++){var p=i[m];var q=p["index"];var k='<a class="list-group-item">';var j=h(p["formatter"],n[q],n);var r=p["name"];if(!r){r=q}k+=r+": "+j;k+="</a>";o+=k}o+="";return o}function g(o,i,l){var j="";for(var p=0,n=o.length;p<n;p++){var k=o[p];var m="$('#"+i+"').MList('operate',["+l+","+p+"])";var q="btn btn-default btn-block"+(k["className"]?" "+k["className"]:"");j+='<a class="list-group-item"><button class="'+q+'" onclick="'+m+'">'+k["name"]+"</button></a>"}return j}function h(i,j,k){if(i&&typeof i==="function"){return i(j,k)}else{return j}}e.version="1.0";window.MList=e;var a={};var f={};$.fn.MList=function(l,i){var m=$(this).attr("id");if(l){var k=typeof l;if(k==="object"){l.elementId=m;var j=new e(l);a[m]=j;return j}else{if(k==="string"){var j=a[m];return j[l](i)}else{return a[m]}}}else{return a[m]}}})(window.jQuery);