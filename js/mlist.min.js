(function(g,b){var f=g.$;function c(l){return new d(l)}function d(l){this.params={elementId:l.elementId||null,itemId:l.itemId||null,query:l.query||null,queryType:l.queryType||"GET",condition:l.condition||null,items:l.items||null,details:l.details||null,action:l.action||null,showNumber:l.showNumber||false,showArrow:l.showArrow||false,buttons:l.buttons||null,imgSrc:l.imgSrc||null,icon:l.icon||null,className:l.className||null,dataAdapter:l.dataAdapter||null,complete:l.complete||null};this.element=f("#"+this.params.elementId);this.element.addClass("list-group mlist-list")}d.prototype.query=function(){var n=this.params;var l=n.elementId;var m=this.element;f.ajax({url:n.query,type:n.queryType,data:n.condition,dataType:"json",success:function(o){if(n["dataAdapter"]&&typeof n["dataAdapter"]==="function"){o=n.dataAdapter(o)}a[l]=o;var s="";for(var r=0,v=o.length;r<v;r++){var t=o[r];var q="$('#"+l+"').MList('toggle',"+r+")";var p='<a class="list-group-item ';if(n["className"]){p+=n.className+" "}p+='mlist-item" href="javascript:'+q+';"';if(n["itemId"]){p+=' item-id="'+t[n["itemId"]]+'"'}if(n["action"]&&typeof n.action==="function"){var u="$('#"+l+"').MList('click',"+r+")";p+=' onclick="'+u+'"'}p+=">";if(n["showNumber"]){p+="<span>"+(r+1)+"</span> "}if(n["imgSrc"]){p+='<img src="'+n.imgSrc+'" /> '}if(n["icon"]){p+='<span class="'+n.icon+'"></span> '}p+=j(n["items"],t);if(n["showArrow"]){p+='<span class="pull-right">&gt;</span>'}p+="</a>";p+='<div class="list-group mlist-details" style="display:none;">';p+=h(n["details"],t);p+=k(n["buttons"],l,r);p+="</div>";s+=p}m.html(s);if(n["complete"]){n.complete(o,m)}}});console.info(this.params.query)};d.prototype.toggle=function(l){var m=this.element;m.find(".mlist-details").eq(l).slideToggle()};d.prototype.click=function(n){var s=this.params;var o=this.element;var p=o.find(".mlist-item").eq(n);var m=s.elementId;var l=a[m];var q=l[n];var r=s["itemId"]?q[s.itemId]:null;s.action(r,q,p)};d.prototype.operate=function(l){var r=l[0];var t=l[1];var m=this.params;var o=this.element;var u=o.find(".mlist-item").eq(r);var p=m.elementId;var q=a[p];var n=q[r];var s=m["itemId"]?n[m.itemId]:null;m.buttons[t].action(s,n,u)};d.prototype.getDatas=function(){var m=this.params;var l=m.elementId;return a[l]};d.prototype.getRow=function(m){var n=this.params;var l=n.elementId;return a[l][m]};function j(l,p){var m="<span>";for(var o=0,s=l.length;o<s;o++){var n=l[o];var r=n["index"];var q="<span>";q+=i(n["formatter"],p[r],p);q+="</span> ";m+=q}m+="</span>";return m}function h(l,q){var r="";for(var p=0,o=l.length;p<o;p++){var s=l[p];var t=s["index"];var n='<a class="list-group-item">';var m=i(s["formatter"],q[t],q);var u=s["name"];if(!u){u=t}n+=u+": "+m;n+="</a>";r+=n}r+="";return r}function k(r,l,o){var m="";for(var s=0,q=r.length;s<q;s++){var n=r[s];var p="$('#"+l+"').MList('operate',["+o+","+s+"])";var t="btn btn-default btn-block"+(n["className"]?" "+n["className"]:"");m+='<a class="list-group-item"><button class="'+t+'" onclick="'+p+'">'+n["name"]+"</button></a>"}return m}function i(l,m,n){if(l&&typeof l==="function"){return l(m,n)}else{return m}}c.version="1.0";g.MList=c;var e={};var a={};f.fn.MList=function(o,l){var p=f(this).attr("id");if(o){var n=typeof o;if(n==="object"){o.elementId=p;var m=new c(o);e[p]=m;return m}else{if(n==="string"){var m=e[p];return m[o](l)}else{return e[p]}}}else{return e[p]}}})(window);